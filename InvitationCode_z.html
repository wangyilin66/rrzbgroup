<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>邀请码管理</title>
    <link rel="stylesheet" href="./layui/css/layui.css">
    <link rel="stylesheet" href="./css/InvitationCode.css">
    <link rel="stylesheet" href="./css/header.css">
    <link rel="stylesheet" href="./css/yyui.css">
    <style>
    .content{
    background-color:#eceff4;
    height:auto;
    padding-bottom: 50px;
}
#test1{
    height: 102px;
    overflow: auto;
    width: 295px;
    position: absolute;
    left: 3px;
    top: 85px;
    background-color: white;
    z-index: 999;
    border: solid rgba(222,225,230,0.3);
    visibility: hidden;
    border-radius: 6px;
    visibility:hidden;
}
#dscode{
	height: 32px;
    cursor: pointer;
    border: none;
    padding-left: 9px;
    box-shadow: 0px 1px 3px #888888;
    margin-top: 6px;
    margin-top: 3px;
    border-radius: 6px;
    width: 224px;
}
#lvip{
			border-bottom: 5px solid rgba(147, 209, 255,1);
		}
        .bluebg{
            color: skyblue;
        }
        .orbg{
            color: orange;
        }
        .redbg{
            color: red;
        }
        .blackbg{
            color: #000;
        }
        #shuju5,#shuju6{
            display: flex;
            justify-content: space-around;
        }
</style>
</head>

<body>
 <!-- 头部 -->
 <header></header>
    <!-- 内容 -->
    <div class="hytitle">
        <div class="hytitle_font" style="border-bottom: solid">发展名额分配</div>
        <div class="hytitle_font">邀请码生成</div>
        <div class="hytitle_font">组织邀请码申请</div>
        <div class="hytitle_font">邀请码补领</div>
        <div class="hytitle_font">邀请码状况跟踪管控</div>
        <div class="hytitle_font">会员邀请状态跟踪</div>
    </div>
    <div class="content">
        <!--发展名额分配  -->
        <div class="content_nav">
            <div class="content_navl"><span><i
                        class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;<a href="./vipfind_z.html" style="color:#5d8bc8;">会员管理</a>&nbsp;&nbsp;</span>/&nbsp;邀请码管理
            </div>
            <div class="content_navi">
                <form class="layui-form" action="">
                    <div class="layui-container-fluid">
                        <div class="layui-fluid">
                            <div class="layui-row">
                                <div class="layui-col-sm3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <label for="">发展年份：
                                            <div>
                                                <select id="nianfen" name="modules" lay-verify="required" lay-search="" lay-filter="fznf_z">
                                                    <option value="">请选择</option>
                                                    <!-- <option value="1">layer</option>
													<option value="2">form</option>
													<option value="3">layim</option> -->
                                                </select>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                <div class="layui-col-sm3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <label for="">入会日期：
                                            <div>
                                                <div class="layui-input-inline">
                                                    <div class="date_font date_tubiao"><i
                                                            class="layui-icon layui-icon-date"></i></div>
                                                    <input type="text" name="date" id="time1" lay-verify="date"
                                                        style="width:122px;display: inline-block" placeholder="开始时间"
                                                        autocomplete="off" class="layui-input">
                                                    <div class="date_font z_tubiao">至</div>
                                                    <input type="text" name="date" id="time2" lay-verify="date"
                                                        style="width:122px;display: inline-block" placeholder="结束时间"
                                                        autocomplete="off" class="layui-input">
                                                    <div class="date_font date_tubiao2" id="qkqk"><i
                                                            class="layui-icon layui-icon-refresh-1" ></i></div>
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                <div class="layui-col-sm12">
                                    <div class="layui-col-sm3" style="margin-top: 2px;">
                                        <div class="grid-demo">
                                            <label for="">推荐单位/人：
                                                <div>
                                                    <input type="text" placeholder="请选择" readonly="readonly" style="width:290px;border-radius: 6px;" id='sanjit' onclick="chuxian()">
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div id="test1"></div>
                                    <div class="layui-col-sm3" style="margin-top: 2px;">
                                        <div class="grid-demo">
                                            <label for="">发展名额数：
                                                <div>
                                                    <input type="text" placeholder="发展名额数" style="cursor:auto;border-radius: 6px;" id="fzmees_z">
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="layui-col-sm3 layui-col-md-offset3">
                                        <div class="hy_btn">
                                            <button type="reset" class="layui-btn layui-btn-danger">清空</button>
                                            <button type="button" class="layui-btn layui-btn-normal" onclick="qrfp_z()">确认分配</button>
                                            <div class="clear"></div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

            </div>

            <div class="findres2">
                <table class="layui-table" lay-skin="line">
                    <colgroup>
                        <col width="150">
                        <col width="200">
                        <col>
                    </colgroup>
                    <thead>
                        <tr class="tatou">
                            <th>序号</th>
                            <th>推荐类型</th>
                            <th>单位类型</th>
                            <th>单位名称</th>
                            <th id="table_count"></th>
                            <th>分配时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="codefenpei_z">
                        <!-- <tr>
                            <td>12313</td>
                            <td>会员单位推荐</td>
                            <td>全国文艺家协会</td>
                            <td>中国影协</td>
                            <td>7</td>
                            <td>2018-05-23 14：23：56</td>
                            <td>
                                <button class="layui-btn">修改</button>
                                <button class="layui-btn layui-btn-danger">删除</button>
                            </td>
                        </tr> -->
                    </tbody>
                </table>
                <div>
                    <div id="shuju1" style="display: flex;justify-content: space-around;"></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
            <div style="display: flex;justify-content: center;margin-top: 19px;">
            	<a href="http://39.98.186.243/clav/inviteCodeWord/getWord1" download=""><button type="button" class="layui-btn layui-btn-normal">一键导出预览</button></a>
                <a><button type="button" class="layui-btn layui-btn-primary" style="margin-left: 20px;" onclick="successfp()">完成分配任务</button></a>
            </div>
            </form>
        </div>
        <!-- 邀请码生产 -->
        <div class="content_nav">
            <div class="content_navl"><span><i
                        class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;<a href="./vipfind_z.html" style="color:#5d8bc8;">会员管理</a>&nbsp;&nbsp;</span>/&nbsp;邀请码管理
            </div>
            <div class="content_navi">
                <form class="layui-form" action="">
                    <div class="layui-container-fluid">
                        <div class="layui-fluid">
                            <div class="layui-row">
                                <div class="layui-col-sm3 layui-col-md-offset9">
                                    <div class="hy_btn" id="newsc">
                                        <!--<button type="button" class="layui-btn layui-btn-normal"id="yjsc_z" onclick="newyjsc()">一键生成</button>
                                        <div class="clear"></div>-->
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>

            </div>

            <div class="findres">
                <button type="button" class="layui-btn layui-btn-normal">批量导出</button>
                <table class="layui-table" lay-skin="line">
                    <colgroup>
                        <col width="150">
                        <col width="200">
                        <col>
                    </colgroup>
                    <thead>
                        <tr class="tatou">
                            <th style="width: 50px">
                                <input type="checkbox" name="" title="" lay-skin="primary" id="checkAll">
                            </th>
                            <th>序号</th>
                            <th>推荐类型</th>
                            <th>单位类型</th>
                            <th>推荐单位/人</th>
                            <th>邀请码</th>
                        </tr>
                    </thead>
                    <tbody id="sccode_z">                       
                    </tbody>
                </table>
                <div>
                    <div id="shuju2" style="display: flex;justify-content: space-around;"></div>
                </div>
            </div>
            <div class="yqm_btn" id="newsc2">
                <!--<button type="button" class="layui-btn layui-btn-normal">完成并下载</button>
                <button type="button" class="layui-btn layui-btn-danger"id="yjsc_z2">全部邀请码重新生成</button>-->
            </div>
            </form>
        </div>
        <!--组织邀请码申请  -->
        <div class="content_nav">
            <div class="content_navl"><span><i
                        class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;<a href="./vipfind_z.html" style="color:#5d8bc8;">会员管理</a>&nbsp;&nbsp;</span>/&nbsp;邀请码管理
            </div>
            <div class="content_navi">
                <form class="layui-form" action="">
                    <div class="layui-container-fluid">
                        <div class="layui-fluid">
                            <div class="layui-row">
                                <div class="layui-col-sm3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <label for="">发展年份：
                                            <div style="display: inline-block">
                                                <select id="nianfen2" name="modules" lay-verify="required" lay-search="" lay-filter="fznf_z2" >
                                                    <option value="">请选择</option>
                                                    <!-- <option value="1">layer</option>
                                                                    <option value="2">form</option>
                                                                    <option value="3">layim</option> -->
                                                </select> 
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                <div class="layui-col-sm3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <label for="">申领推荐单位/人：</label>
                                        <input type="text" placeholder="请选择" id='dscode' readonly="readonly" style="cursor: pointer;" onclick="chuxian2()">                                       
                                    	<img src="img/sanjiao.png" style="width: 26px;position: absolute;top: 30px;left: 322px;"/>
                                    </div>
                                    <div id="test2">
                                    	
                                    </div>
                                </div>
                                <div class="layui-col-sm3 layui-col-md-offset3">
                                    <div class="hy_btn">
                                        <button type="button" class="layui-btn layui-btn-normal" onclick="zuzycf()">查询</button>
                                        <!--<a href="http://39.98.186.243/clav/inviteCodeWord/getWord" download="">-->
                                        	<button type="button" class="layui-btn layui-btn-normal" onclick="yiicb()">一键申领并传播</button>
                                        <!--</a>-->
                                        <div class="clear"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>
            <div class="findres">
                <button type="button" class="layui-btn layui-btn-normal">批量导出</button>
                <table class="layui-table" lay-skin="line">
                    <colgroup>
                        <col width="150">
                        <col width="200">
                        <col>
                    </colgroup>
                    <thead>
                        <tr class="tatou">
                            <th>序号</th>
                            <th>发展年份</th>
                            <th>单位名称</th>
                            <th>发展名额数</th>
                            <th>申请状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="zzyqmsq_z">
                        
                    </tbody>
                </table>
                <div>
                    <div id="shuju3" style="display: flex;justify-content: space-around;"></div>
                </div>
            </div>
            </form>
        </div>
        <!-- 邀请码补领 -->
        <div class="content_nav">
            <div class="content_navl"><span><i
                        class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;<a href="./vipfind_z.html" style="color:#5d8bc8;">会员管理</a>&nbsp;&nbsp;</span>/&nbsp;邀请码管理
            </div>
            <div class="content_navi">
                <form class="layui-form" action="">
                    <div class="layui-container-fluid">
                        <div class="layui-fluid">
                            <div class="layui-row">
                                <div class="layui-col-sm3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <label for="">发展年份：
                                            <div>
                                                <select id="fznfinp" name="modules" lay-verify="required" lay-search="" lay-filter="fznfinp">
                                                    <option value="">请选择</option>
                                                    <!-- <option value="1">layer</option>
                                                                        <option value="2">form</option>
                                                                        <option value="3">layim</option> -->
                                                </select>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                <div class="layui-col-sm3">
                                    <div class="grid-demo grid-demo-bg1">
                                        <label for="">补领推荐单位/人：
                                            <div>
                                                <select id="bltj" name="modules" lay-verify="required" lay-search="" lay-filter="bltj">
                                                    <option value="">请选择</option>
                                                    <!-- <option value="1">layer</option>
                                                                            <option value="2">form</option>
                                                                            <option value="3">layim</option> -->
                                                </select>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                <div class="layui-col-sm12">
                                        <div class="layui-col-sm3" style="margin-top: 2px;">
                                                <div class="grid-demo grid-demo-bg1">
                                                        <label for="">补领邀请码：
                                                            <div style="display: inline-block">
                                                                <input id='yqmnum' type="text" style="width: 36px;margin-right: 15px;margin-top: 19px;">个
                                                            </div>
                                                        </label>
                                                    </div>
                                        </div> 
                                <div class="layui-col-sm3 layui-col-md-offset6">
                                    <div class="hy_btn">
                                    	<button type="button" class="layui-btn layui-btn-normal">导出</button>
                                        <button type="button" id='blbut' class="layui-btn layui-btn-normal">确认补领</button>
                                        <!--<button type="button" class="layui-btn layui-btn-normal">导出</button>-->
                                        <div class="clear"></div>
                                    </div>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
            </div>
            <div class="findres" id="codelist">
                <!-- <div class="bl_code">W12345678915</div> -->
               
            </div>
            </form>
        </div>
        <!-- 邀请码状况跟踪管控 -->
        <div class="content_nav">
                <div class="content_navl"><span><i
                            class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;<a href="./vipfind_z.html" style="color:#5d8bc8;">会员管理</a>&nbsp;&nbsp;</span>/&nbsp;邀请码状态跟踪
                </div>
                <div class="content_navi">
                    <form class="layui-form" action="">
                        <div class="layui-container-fluid">
                            <div class="layui-fluid">
                                <div class="layui-row">
                                    <div class="layui-col-sm3">
                                        <div class="grid-demo grid-demo-bg1">
                                            <label for="">推荐单位/人：
                                                <div>
                                                    <select id="gztjdw" name="modules" lay-verify="required" lay-search=""  lay-filter="gztjdw">
                                                        <option value="">请选择</option>
                                                        <!-- <option value="1">layer</option>
                                                                        <option value="2">form</option>
                                                                        <option value="3">layim</option> -->
                                                    </select>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="layui-col-sm3">
                                            <div class="grid-demo grid-demo-bg1">
                                                <label for="">邀请码：
                                                    <div>
                                                        <input type="text" id='gzinp2' placeholder="邀请码" style="border-radius: 6px;">
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    <div class="layui-col-sm3">
                                        <div class="grid-demo grid-demo-bg1">
                                            <label for="">状态：
                                                <div >
                                                    <select id="yishu" name="modules" lay-verify="required" lay-search="" lay-filter="gzzt">
                                                        <option value="">请选择</option>
                                                        <option value="1">以申领</option>
                                                        <option value="2">以使用</option>
                                                        <option value="3">已失效</option>
                                                        <option value="4">已通过</option>
                                                        <!-- <option value="1">layer</option>
                                                                            <option value="2">form</option>
                                                                            <option value="3">layim</option> -->
                                                    </select>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="layui-col-sm3">
                                        <div class="hy_btn">
                                            <button type="button" id="gzgkbut" class="layui-btn layui-btn-normal">查询</button>
                                            <div class="clear"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
                <div class="findres2">
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="150">
                            <col width="200">
                            <col>
                        </colgroup>
                        <thead>
                            <tr class="tatou">
                                <th>序号</th>
                                <th>推荐类型</th>
                                <th>单位类型</th>
                                <th>单位名称</th>
                                <th>发展名额数</th>
                                <th>邀请码</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody  id='tbb'>
                            <!-- <tr>
                                <td>1</td>
                                <td>会员单位推荐</td>
                                <td>全国文艺家协会</td>
                                <td>中国剧协</td>
                                <td>7</td>
                                <td>W15675493535</td>
                                <td style="color: skyblue">已申领</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>会员单位推荐</td>
                                <td>全国文艺家协会</td>
                                <td>中国剧协</td>
                                <td>7</td>
                                <td>W15675493535</td>
                                <td style="color: skyblue">已申领</td>
                            </tr> -->
                        </tbody>
                    </table>
                    <div>
                        <div id="shuju5"></div>
                    </div>
                </div>
                </form>
            </div>
        <!--会员邀请状态跟踪  -->
        <div class="content_nav">
                <div class="content_navl"><span><i
                            class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;<a href="./vipfind_z.html" style="color:#5d8bc8;">会员管理</a>&nbsp;&nbsp;</span>/&nbsp;会员邀请状态跟踪
                </div>
                <div class="content_navi">
                    <form class="layui-form" action="">
                        <div class="layui-container-fluid">
                            <div class="layui-fluid">
                                <div class="layui-row">
                                    <div class="layui-col-sm3">
                                        <div class="grid-demo grid-demo-bg1">
                                            <label for="">发展年份：
                                                <div style="display: inline-block">
                                                    <select id="ztyearinp" name="modules" lay-verify="required" lay-search=""  lay-filter="ztyearinp">
                                                        <option value="">请选择</option>
                                                        <!-- <option value="1">layer</option>
                                                                        <option value="2">form</option>
                                                                        <option value="3">layim</option> -->
                                                    </select>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="layui-col-sm3">
                                        <div class="grid-demo grid-demo-bg1">
                                            <label for="">推荐单位：
                                                <div style="display: inline-block">
                                                    <select id="zttjdwinp" name="modules" lay-verify="required" lay-search=""  lay-filter="zttjdwinp">
                                                        <option value="">请选择</option>
                                                        <!-- <option value="1">layer</option>
                                                                            <option value="2">form</option>
                                                                            <option value="3">layim</option> -->
                                                    </select>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="layui-col-sm3 layui-col-md-offset3">
                                        <div class="hy_btn">
                                            <button type="button" id="yqztbut" class="layui-btn layui-btn-normal">查询</button>
                                            <div class="clear"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
                <div class="findres2">
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="150">
                            <col width="200">
                            <col>
                        </colgroup>
                        <thead>
                            <tr class="tatou">
                                <th>单位名称</th>
                                <th>发展目标/th>
                                <th>剩余名额</th>
                                <th>审核通过</th>
                                <th>完成比例</th>
                            </tr>
                        </thead>
                        <tbody id='zttbody'>
                            <!-- <tr>
                                <td>中国剧协</td>
                                <td>20</td>
                                <td>8</td>
                                <td>7</td>
                                <td>20%</td>
                            </tr>
                            <tr>
                                <td>中国剧协</td>
                                <td>20</td>
                                <td>8</td>
                                <td>7</td>
                                <td>30%</td>
                            </tr> -->
                        </tbody>
                    </table>
                    <div>
                        <div id="shuju6"></div>
                    </div>
                </div>
                </form>
            </div>
    </div>
    <div class="cover11">
		<div class="tcc_content">
			<div class="tcc_title">分配信息</div>
			<div class="findfile2 hnzw2">
				<div style="margin-top: 67px;" id="nfpinfo"></div>
			</div>
			<div class="findfile_an">
					<button type="button" class="layui-btn layui-btn-normal" id=""onclick="close1()">确定</button>
				<button type="button" class="layui-btn layui-btn-primary" onclick="close1()">关闭</button>
			</div>
		</div>
    </div>
    <div class="cover5">
		<div class="tcc_content">
			<div class="tcc_title">修改分配情况</div>
			<div class="findfile hnzw">
				发展名额数：<input type="text" id="fzmes_z">
			</div>
			<div class="findfile_an">
					<button type="button" class="layui-btn layui-btn-normal" id="fzmesqd_z"onclick="fzmesqd_z()">确定</button>
				<button type="button" class="layui-btn layui-btn-primary" onclick="close1()">关闭</button>
			</div>
		</div>
	</div>
    <div class="cover4">
		<div class="tcc_content">
			<div class="tcc_title">温馨提示</div>
			<div class="findfile2 hnzw2">
				<div style="margin-top: 67px;">邀请码重新生成将把所有邀请码标记为不可用，如邀请码已经发送出去，<br>请慎用。</div>
			</div>
			<div class="findfile_an">
					<button type="button" class="layui-btn layui-btn-normal" id=""onclick="yijiansc()">确定</button>
				<button type="button" class="layui-btn layui-btn-primary" onclick="close1()">关闭</button>
			</div>
		</div>
    </div>
    <div class="cover6">
		<div class="tcc_content">
			<div class="tcc_title">邀请码详情</div>
            <div class="findfile codeinfo_z" style="height:205px;margin-top: 8px;border: solid rgba(195, 197, 201, 0.3);padding-left: 76px;overflow: auto;border-width: 1px;">
                <!-- <div style="display: inline-block;font-size: 16px;padding-top: 10px;width: 45%">1qweqeqeq2</div> -->
            </div>
            <div>
                <button  style="float: right;margin-right: 10px;margin-top: 9px;"class="layui-btn layui-btn-primary"onclick="close1()">关闭</button>
            </div>
		</div>
    </div>
    <div class="cover7">
		<div class="tcc_content">
			<div class="tcc_title">邀请码详情</div>
            <div class="findfile codeinfo_z2" style="height:205px;margin-top: 8px;border: solid rgba(195, 197, 201, 0.3);padding-left: 76px;overflow: auto;border-width: 1px;">
                <!-- <div style="display: inline-block;font-size: 16px;padding-top: 10px;width: 45%">1qweqeqeq2</div> -->
            </div>
            <div>
                <button  style="float: right;margin-right: 10px;margin-top: 9px;"class="layui-btn layui-btn-primary"onclick="close1()">关闭</button>
            </div>
		</div>
	</div>
    <script src="./layui/layui.js"></script>
    <script src="./js/layuicommon2.js"></script>
    <script src="./js/jquery.min.js"></script>
    <script src="./js/header.js"></script>
    <script src="./js/common.js"></script>
    <!-- <script src="./js/commonheader.js"></script> -->
    <script src="./js/InvitationCode_z.js"></script>
	<script>
        let treedata = [];
        let fznfinp,bltj,gztjdw,gzzt,ztyearinp,zttjdwinp;
        let ind1;
        function close1() {
			$(".cover5,.cover4,.cover6,.cover7,.cover11").css( "display", "none");
        }
        function chuxian(){
            $("#test1").css( "visibility", "visible");	
        }
        function chuxian2(){
            $("#test2").css( "visibility", "visible");	
        }
//      $('#yjsc_z').click(function(){
//          $('.cover4').css( "display", "block");
//      })
        $('#yjsc_z2').click(function(){
            $('.cover4').css( "display", "block");
        })
        $('#qkqk').click(function(){
            $('#time1').val('');
            $('#time2').val('');
        })
		// 引的头部
        $('header').load('./headerys.html');
        $('.content_nav').eq(0).show().siblings().hide();
        $(".tatou").css({ "background-color": "#059afe", "color": "white" });
        $('.hytitle_font').click(function () {
            var i = $(this).index();
            $('.hytitle_font').css("border-bottom", "");
            $('.hytitle_font').eq(i).css("border-bottom", "solid");
            $('.content_nav').eq(i).show().siblings().hide();
        });
        $('#test1').mouseleave(function(){
			$('#test1').css("visibility", "hidden");
		})
        $('#test2').mouseleave(function(){
			$('#test2').css("visibility", "hidden");
		})
        var data = {
        }
        base.commonAjax('clav/recommendUnit/getAllUnitList', data, function (data) {
            if (data.code == 1) {
                //console.log("z", data);
                treelocaldata = data.data;
                wtf(data.data);
               // console.log(treedata)
                layui.use('tree', function () {
                    var tree = layui.tree;

                    //渲染
                    var inst1 = tree.render({
                        elem: '#test1'  //绑定元素
                        ,click: function(obj){
                       // console.log(obj.data); //得到当前点击的节点数据
                       // console.log(obj.elem); //得到当前节点元素 
                        // console.log($('.layui-tree-set').attr("data-id"));
                      //  console.log(obj.data.id); //得到当前点击的节点数据
                        let str = obj.data.id;
                       // let strss = str.indexOf('-');
                        if(String(str).indexOf('-') != -1){
							 
                             let arr = str.split('-');
                             if(arr.length == 2){
                                 console.log(treelocaldata[Number(arr[0])].childList[Number(arr[1])]);
                                 ind1 = treelocaldata[Number(arr[0])].childList[Number(arr[1])].id;
                                 title1 = treelocaldata[Number(arr[0])].childList[Number(arr[1])].name;
                                //console.log(ind1,title1)
                                $('#sanjit').val(title1);
                                $('#test1').css("visibility","hidden");
                                 }
                                 if(arr.length == 3){
                                 console.log(treelocaldata[Number(arr[0])].childList[Number(arr[1])].childList[Number(arr[2])]);
                                 ind1 = treelocaldata[Number(arr[0])].childList[Number(arr[1])].childList[Number(arr[2])].id;
                                 title1 = treelocaldata[Number(arr[0])].childList[Number(arr[1])].childList[Number(arr[2])].name;
                                //console.log(ind1,title1)
                                $('#sanjit').val(title1);
                                $('#test1').css("visibility","hidden");
                                 }
                             } else {
                                 let arr = str;
                                 console.log(arr);
                                 console.log(treelocaldata[arr]);
                                 ind1 = treelocaldata[arr].id;
                                 title1 = treelocaldata[arr].name;
                                 //console.log(title1)
                                 $('#sanjit').val(title1);
                                 $('#test1').css("visibility","hidden");
                             }
                    }
                        , data:treedata
                    });
                    
                });
            }
        });
        function wtf(data) {
            data.map(function(v, i) {
                let obj = {};
                obj.title = v.name;
                obj.id = i;
                obj.children = [];
                v.childList.map(function(val, ind) {
                    let objc = {};
                    objc.title = val.name;
                    objc.id = i+'-'+ind;
                    objc.children = [];
                    val.childList.map(function(vv, ii) {
                        let objcc = {};
                        objcc.title = vv.name;
                        objcc.id = i+'-'+ind + '-' + ii;
                        objc.children.push(objcc);
                    })
                    obj.children.push(objc);
                });
                treedata.push(obj);
            });
        }
        layui.use('form', function(){
          var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功
       form.on('select(fznf_z)',function(data){
        fznf_z=data.value;
           //mz3=data.elem[data.elem.selectedIndex].text;
           form.render('select');
       })
    })
   function qrfp_z(){
   	if($('#nianfen').val()==''){
   		alert('请选择年份')
   		return false;
   	}if($('#time1').val()==''){
   		alert('填写入会日期')
   		return false;
   	}
   	if($('#time2').val()==''){
   		alert('填写入会日期')
   		return false;
   	}
   	if(($('#fzmees_z').val())==''){
   		alert('填发展名额数')
   		return false;
   	}
   	if($('#sanjit').val()==''){
   		alert('请选择推荐单位/人')
   		return false;
   	}
    //console.log("提交",ind1)
    var startTime=$('#time1').val();
    var endTime=$('#time2').val();
    var placeCount=$('#fzmees_z').val();
    var data={
        startTime:startTime,
        endTime:endTime,
        year:fznf_z,
        units:ind1,
        placeCount:placeCount
    }
    //console.log("提交",data)
    base.commonAjax('clav/allotInfo/addDevelopPlace', data, function (data) {
    	//console.log('邀请码',data)
        if(data.code==1){
//          alert('分配成功')
			$('.cover11').css( "display", "block");
			$('#nfpinfo').empty();
			$('#nfpinfo').append(
				'本次规划推荐单位/人'+data.tjCount+',共发展名额'+data.meCount+'个。'
			)
            codelist_z();
        }
        else{
        	alert(data.message);
        }
    })
   }
  // <div class="bl_code">W12345678915</div>

//   base.commonAjax('clav/allotInfo/addInviteReplaceInfo/', {}, function (data) {
//     console.log(data);
//         if(data.code==1){
//          console.log(data);
//         }else{
//             console.log('邀请码获取失败');
//         }
//     });
   

    // $.ajax({
    //         url: 'http://39.98.186.243/clav/allotInfo/addInviteReplaceInfo', //获取数据的url
    //         dateType: "json", //参数返回的类型
    //         type: "POST", //参数传送的方式
    //         data: {},
    //         traditional: true,
    //         beforeSend: function(xhr) {
    //                     xhr.setRequestHeader("Origin:'1333333333'");
    //                 },
    //         async: true,
    //         success: function (data) {
    //             //请求成功后的回调函数
    //             console.log(data);
    //             if(data.code == 1){
    //                 // window.location.href = "applyFormPage_w.html";
                     
    //             }else{
                  
    //             }
    //         }
    //     });


    layui.use('form', function(){
			  var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功
			
			//年份
					var data = {
					}
					base.commonAjax('clav/allotInfo/getYearList', data, function (data) {
						//console.log(data.data[0])
							if (data.code == 1) {
									//console.log(data);      
									for (var i = 0; i < data.data.length; i++) {
											$('#fznfinp').append(
													'<option value="' + data.data[i] + '">' + data.data[i] + '</option>'
                                            );
											$('#ztyearinp').append(
													'<option value="' + data.data[i] + '">' + data.data[i] + '</option>'
                                            );
                              

									}
									form.render();
							}
                    });
                    labelType=3;
					var data2={
						labelType:labelType
					}
					base.commonAjax('clav/recommendUnit/selectByLabelType', data2, function (data) {
						if (data.code == 1) {
							for (var i = 0; i < data.data.length; i++) {
								$('#bltj').append(
										'<option value="' + data.data[i].id + '">' + data.data[i].name + '</option>'
								);
								$('#gztjdw').append(
										'<option value="' + data.data[i].id + '">' + data.data[i].name + '</option>'
								);
						
								$('#zttjdwinp').append(
										'<option value="' + data.data[i].id + '">' + data.data[i].name + '</option>'
								);
						
						}
						form.render();
						}
					})

    });
    
        $('#blbut').on('click', function () {
            console.log(fznfinp);
            console.log(bltj);
            console.log($('#yqmnum').val());
            let vals = $('#yqmnum').val();
            if (fznfinp && bltj && vals != '') {
                let data2 = {
                    year:fznfinp,
                    units:bltj,
                    placeCount:vals
                }
                base.commonAjax('clav/allotInfo/addInviteReplaceInfo', data2, function (data) {
                    console.log(data);
                    if (data.code == 1) {
                     data.data.map(function (v,i) {
                     $('#codelist').append('<div class="bl_code">'+v.inviteCode+'</div>')
                       });
                    }else{
                        alert('补领信息填写错误，请填写或选择正确的格式');
                    }
                })
            }
        });

    $('#gzgkbut').on('click', function () {
        console.log(gztjdw);
        console.log(gzzt);
        console.log($('#gzinp2').val());
        let data = {
            inviteCode:$('#gzinp2').val(),
            unitId:gztjdw,
            status:gzzt,
        }

        base.commonAjax('clav/allotInfo/getInviteCodeList', data, function (data) {
         console.log(data);
      
                var pagedata = [];
			console.log(data);
			pagedata = data.data;
			//console.log(pagedata)

			//调用分页
			layui.use(['laypage', 'layer'], function () {
				var laypage = layui.laypage
					, layer = layui.layer;

				laypage.render({
					elem: 'shuju5'
					, count: pagedata.length,
					layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
					limit: 2,
					jump: function (obj) {
						//模拟渲染
						document.getElementById('tbb').innerHTML = function () {
							var arr = []
								, thisData = pagedata.concat().splice(obj.curr * obj.limit - obj.limit, obj.limit);
							layui.each(thisData, function (index, item) {
								arr.push(auto5(item,index));
								console.log(item);
							});
							return arr.join('');
						}();
					}
				});
			});
            


		});


        

    });
//邀请码状态跟踪管控
    base.commonAjax('clav/allotInfo/getInviteCodeList', data, function (data) {
         console.log(data);
      
                var pagedata = [];
			console.log(data);
			pagedata = data.data;
			//console.log(pagedata)

			//调用分页
			layui.use(['laypage', 'layer'], function () {
				var laypage = layui.laypage
					, layer = layui.layer;

				laypage.render({
					elem: 'shuju5'
					, count: pagedata.length,
					layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
					limit: 2,
					jump: function (obj) {
						//模拟渲染
						document.getElementById('tbb').innerHTML = function () {
							var arr = []
								, thisData = pagedata.concat().splice(obj.curr * obj.limit - obj.limit, obj.limit);
							layui.each(thisData, function (index, item) {
								arr.push(auto5(item,index));
								console.log(item);
							});
							return arr.join('');
						}();
					}
				});
			});
            
        });
        
        //会员邀请码状态跟踪
        base.commonAjax('clav/allotInfo/getStatusGenZongList', {}, function (data) {
         console.log(data);
      
                var pagedata = [];
			console.log(data);
			pagedata = data.data;
			//console.log(pagedata)

			//调用分页
			layui.use(['laypage', 'layer'], function () {
				var laypage = layui.laypage
					, layer = layui.layer;

				laypage.render({
					elem: 'shuju6'
					, count: pagedata.length,
					layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
					limit: 2,
					jump: function (obj) {
						//模拟渲染
						document.getElementById('zttbody').innerHTML = function () {
							var arr = []
								, thisData = pagedata.concat().splice(obj.curr * obj.limit - obj.limit, obj.limit);
							layui.each(thisData, function (index, item) {
								arr.push(auto6(item,index));
								console.log(item);
							});
							return arr.join('');
						}();
					}
				});
			});

        });
        
        $('#yqztbut').on('click',function () { 
            let data = {
                remarks1:ztyearinp,
                unitId:zttjdwinp
            };

        console.log(data);
            base.commonAjax('clav/allotInfo/getStatusGenZongList', data, function (data) {
         console.log(data);
      
                var pagedata = [];
			console.log(data);
			pagedata = data.data;
			//console.log(pagedata)

			//调用分页
			layui.use(['laypage', 'layer'], function () {
				var laypage = layui.laypage
					, layer = layui.layer;

				laypage.render({
					elem: 'shuju6'
					, count: pagedata.length,
					layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
					limit: 2,
					jump: function (obj) {
						//模拟渲染
						document.getElementById('zttbody').innerHTML = function () {
							var arr = []
								, thisData = pagedata.concat().splice(obj.curr * obj.limit - obj.limit, obj.limit);
							layui.each(thisData, function (index, item) {
								arr.push(auto6(item,index));
								console.log(item);
							});
							return arr.join('');
						}();
					}
				});
			});

        });

         })


    function auto5(obj,ind) {
			let str = '';
			let str2 = '';


			if(obj.status == 1){
                str2 = '已申领';
                str='bluebg';
            }
			if(obj.status == 2){
                str2 = '已使用';
                str='orbg';
            }
			if(obj.status == 3){
                str2 = '已失效';
                str='redbg';
            }
			if(obj.status == 4){
                str2 = '已通过';
                str='blackbg';
            }
            

			return '<tr>' +
				'<td>' + (ind+1) + '</td>' +
				'<td>' + obj.tjType + '</td>' +
				'<td>' + obj.dwType + '</td>' +
				'<td>' + obj.dwName + '</td>' +
				'<td>' + obj.placeCount + '</td>' +
				'<td>' + obj.inviteCode + '</td>' +
                '<td class="'+str+'">' + str2 + '</td>' +
				'</tr>'
        };


        function auto6(obj,ind) {
			let str = '';
			let str2 = '';


			if(obj.status == 1){
                str2 = '已申领';
                str='bluebg';
            }
			if(obj.status == 2){
                str2 = '已使用';
                str='orbg';
            }
			if(obj.status == 3){
                str2 = '已失效';
                str='redbg';
            }
			if(obj.status == 4){
                str2 = '已通过';
                str='blackbg';
            }
            

			return '<tr>' +
				'<td>' + obj.name + '</td>' +
				'<td>' + obj.placeCount + '</td>' +
				'<td>' + obj.remainCount + '</td>' +
				'<td>' + obj.accessCount + '</td>' +
				'<td>' + obj.finishBiLi + '</td>'  +
				'</tr>'
        };

        
   layui.use('form', function () {
			var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功
			form.on('select(fznf_z2)', function (data) {
				category_z = data.value;
				//yishu = data.elem[data.elem.selectedIndex].text;
				form.render('select');
           })
            form.on('select(fznfinp)', function (data) {
				fznfinp = data.value;
				//dscode = data.elem[data.elem.selectedIndex].text;
				form.render('select');
            })
            form.on('select(bltj)', function (data) {
				bltj = data.value;
				//dscode = data.elem[data.elem.selectedIndex].text;
				form.render('select');
            })
            form.on('select(gztjdw)', function (data) {
				gztjdw = data.value;
				//dscode = data.elem[data.elem.selectedIndex].text;
				form.render('select');
            })
            form.on('select(gzzt)', function (data) {
				gzzt = data.value;
				//dscode = data.elem[data.elem.selectedIndex].text;
				form.render('select');
            })
            form.on('select(ztyearinp)', function (data) {
				ztyearinp = data.value;
				//dscode = data.elem[data.elem.selectedIndex].text;
				form.render('select');
            })
            form.on('select(zttjdwinp)', function (data) {
				zttjdwinp = data.value;
				//dscode = data.elem[data.elem.selectedIndex].text;
				form.render('select');
            })
		})
   </script>
</body>

</html>