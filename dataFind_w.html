<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>会员查询</title>
	<link rel="stylesheet" href="./layui/css/layui.css">
	<link rel="stylesheet" href="./css/hyfind.css">
	<link rel="stylesheet" href="./css/header.css">
	<style>
		.content_nav {
			width: 80%;
			padding-bottom: 30px;
		}

		.content {
			height: auto;
		}

		.c_n_lis {
			width: 100%;
			margin-top: 30px;
			display: flex;
			position: relative;
		}

		.c_n_lis1 {
			margin-top: 30px;
		}

		.n_l_cont {
			width: 272px;
			margin-left: 40px;
		}

		.n_l_cont1 {
			margin-left: 0 !important;
		}

		.n_l_cont>p {
			margin-bottom: 10px;
			font-size: 14px;
			font-weight: 600;
			padding-left: 4px;
		}

		.layui-input,
		.layui-unselect {
			width: 272px;
			height: 30px;
		}

		.inpbox {
			width: 272px;
			height: 30px;
			display: flex;
		}

		.ib_cont>.layui-form-select {
			width: 80px;
			height: 30px;
		}

		.ib_cont>.layui-form-select>.layui-select-title>.layui-input {
			width: 80px;
			height: 30px;
		}

		.i_b_tit {
			width: 50px;
			line-height: 30px;
			text-align: center;

		}

		.hytitle {
			margin-left: 100px;
		}

		#xszdinp {
			width: 100%;
			height: 30px;
			z-index: 0;
			border: 0;
			border-radius: 6px;
			box-sizing: border-box;
			padding-left: 10px;
		}

		#test3 {
			width: 272px;
			height: 30px;
			position: absolute;
			left: 0;
			z-index: 99;
			height: 128px;
			overflow: auto;
			border: solid rgba(222, 225, 230, 0.1) 1;
			visibility: hidden;
			background-color: white;
		}
		.l_c_box{
			width: 272px;
			display: flex;
		}
		.layui-icon-table,.layui-icon-refresh-3{
			width: 30px !important;
			height: 28px;
			display: block;
			text-align: center;
			font-size: 20px;
			padding: 0 4px;
			background: #fff;
			line-height: 30px;
			cursor:pointer;
			border:1px solid #ccc;
		}
		.layui-icon-refresh-3{
		font-size: 16px;
		padding: 0 6px;
		}
		.c_b_tits{
			display: block;
			width: 30px;
			height: 27px;
			margin-top: 1px;
			text-align: center;
			line-height: 30px;
			background: #fff;
			padding: 0 8px;
		}
		.n_l_but{
			position: absolute;
			bottom:0;
			right: 30px;
		}
		.n_l_but > div{
           width:74px;
		   height: 34px;
		   text-align: center;
		   line-height: 34px;
		   color: #fff;
		   border-radius: 4px;
		   float: left;
		   cursor:pointer;
		}
		.chaxun{
			background: #0081FF;
		}
        .qingkong{
			background: #9E9E9E;
			margin-left: 24px;
		}
	</style>
</head>

<body>
		<!-- 头部 -->
		<div class="headerpage">
				<div class="layui-container-fluid">
					<div class="layui-fluid">
						<div class="layui-row layui-col-space5">
							<div class="layui-col-md5" style="padding-right: 0px;">
								<div class="wltop">
									<div class="logo">
										<img src="./img/admin_logo.png" alt="">
									</div>
								</div>
							</div>
							<div class="layui-col-md7" style="padding-left: 0px;">
								<ul class="layui-nav layui-bg-blue tou">
									<li class="layui-nav-item layui-this"><a href="">首页</a></li>
									<li class="layui-nav-item">
										<a href="javascript:;">志愿者管理</a>
										<dl class="layui-nav-child">
												<dd><a href="removeUserPage_w.html">理事调整</a></dd>
												<dd><a href="addvipPage_w.html">增补会员单位</a></dd>
											<dd><a href="">电商平台</a></dd>
										</dl>
									</li>
									<li class="layui-nav-item">
										<a href="javascript:;">组织管理</a>
										<dl class="layui-nav-child">
											<dd><a href="">移动模块</a></dd>
											<dd><a href="">后台模版</a></dd>
											<dd><a href="">电商平台</a></dd>
										</dl>
									</li>
									<li class="layui-nav-item">
										<a href="javascript:;">活动管理</a>
										<dl class="layui-nav-child">
											<dd><a href="">移动模块</a></dd>
											<dd><a href="">后台模版</a></dd>
											<dd><a href="">电商平台</a></dd>
										</dl>
									</li>
									<li class="layui-nav-item">
										<a href="javascript:;">会员管理</a>
										<dl class="layui-nav-child">
											<dd><a href="#">会员查询</a></dd>
											<dd><a href="./vipcheck_z.html">审核管理</a></dd>
											<dd><a href="./recommendedUnits_z.html">推荐单位管理</a></dd>
											<dd><a href="./vipduty_z.html">会员职位管理</a></dd>
											<dd><a href="./InvitationCode_z.html">邀请码管理</a></dd>
											<dd><a href="managementPage_w.html">通知管理</a></dd>
											<dd><a href="dataFind_w.html">会员信息统计</a></dd>
											<dd><a href="">会费管理</a></dd>
										</dl>
									</li>
									<li class="layui-nav-item">
										<a href="javascript:;">系统管理</a>
										<dl class="layui-nav-child">
											<dd><a href="">移动模块</a></dd>
											<dd><a href="">后台模版</a></dd>
											<dd><a href="">电商平台</a></dd>
										</dl>
									</li>
									<li class="layui-nav-item">
										<a href="javascript:;">统计报表</a>
										<dl class="layui-nav-child">
											<dd><a href="">移动模块</a></dd>
											<dd><a href="">后台模版</a></dd>
											<dd><a href="">电商平台</a></dd>
										</dl>
									</li>
									<li class="layui-nav-item"><a href="">系统管理员</a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
	<!-- 内容 -->
	<div class="hytitle">
		<div class="hytitle_font2">统计结果展示</div>
		<div class="hytitle_font">会员数据查询</div>
	</div>
	<div class="mapdiv">


	</div>
	<div class="content">
		<div class="content_nav">
			<div class="content_navl"><span><i
						class="layui-icon layui-icon-home"></i>首页&nbsp;&nbsp;</span>/<span>&nbsp;会员管理&nbsp;&nbsp;</span>/&nbsp;会员信息统计
			</div>
			<div class="content_navi">
				<form class="layui-form" action="">

					<div class="c_n_lis c_n_lis1">
						<div class="n_l_cont n_l_cont1">
							<p>性别：</p>

							<select name="hy" lay-verify="xbinp" id="xbinp">
								<option value="">请选择</option>
								<option value="1">男</option>
								<option value="2">女</option>
							</select>

						</div>
						<div class="n_l_cont">
							<p>年龄：</p>
							<div class="inpbox">
								<div class="ib_cont">
									<select name="hy" lay-verify="nlinp1" id="nlinp1">
										<option value="">0</option>
									</select>
								</div>
								<div class="i_b_tit">至</div>
								<div class="ib_cont">
									<select name="hy" lay-verify="nlinp2" id="nlinp2">
										<option value="">100</option>
									</select>
								</div>
							</div>
						</div>

						<div class="n_l_cont">
							<p>民族：</p>

							<select name="hy" lay-verify="mzinp" id="mzinp">
								<option value="">请选择</option>
							</select>

						</div>

						<div class="n_l_cont">
							<p>籍贯：</p>

							<select name="hy" lay-verify="jginp" id="jginp">
								<option value="">请选择</option>
							</select>

						</div>

					</div>
					<div class="c_n_lis">
						<div class="n_l_cont n_l_cont1">
							<p>现所在地：</p>

							<input id='xszdinp' type="text" />
							<div id='test3'></div>
						</div>
						<div class="n_l_cont">
							<p>文化程度：</p>

							<select name="hy" lay-verify="whcdinp" id="whcdinp">
								<option value="">请选择</option>
							</select>
						</div>
						<div class="n_l_cont">
							<p>政治面貌：</p>

							<select name="hy" lay-verify="mminp" id="mminp">
								<option value="">请选择</option>
							</select>
						</div>
						<div class="n_l_cont">
							<p>新文艺群体：</p>

							<select name="hy" lay-verify="wyqtinp" id="wyqtinp">
								<option value="">请选择</option>
								<option value="1">是</option>
								<option value="2">否</option>
							</select>
						</div>
					</div>
					<div class="c_n_lis">
							<div class="n_l_cont n_l_cont1">
								<p>艺术门类：</p>
	
								<select name="hy" lay-verify="ysmlinp" id="ysmlinp">
										<option value="">请选择</option>
									</select>
							</div>
							<div class="n_l_cont">
								<p>推荐单位/人：</p>
	
								<select name="hy" lay-verify="tjdwinp" id="tjdwinp">
									<option value="">请选择</option>
								</select>
							</div>
							<div class="n_l_cont">
								<p>组织身份：</p>
	
								<select name="hy" lay-verify="zzsfinp" id="zzsfinp">
									<option value="">请选择</option>
								</select>
							</div>
						</div>

						<div class="c_n_lis">
								<div class="n_l_cont n_l_cont1">
									<p>入会时间：</p>
		
									<div class="l_c_box">
											<i class="layui-icon layui-icon-table"></i>  
											<input type="text" name="date" id="time1" lay-verify="date"
											style="width:122px;display: inline-block" placeholder="开始时间"
											autocomplete="off" class="layui-input">
											<div class="c_b_tits">至</div> 
											<input type="text" name="date" id="time2" lay-verify="date"
												style="width:122px;display: inline-block" placeholder="结束时间"
												autocomplete="off" class="layui-input">
												<i class="layui-icon layui-icon-refresh-3"></i>  
											
									</div>
								</div>

								<div class="n_l_but">
								<div class="chaxun">查询</div>
								<div class="qingkong">清空条件</div>
								</div>

							</div>
				</form>
			</div>
			<div class="hy_btn">

			</div>
			<div class="findres">
				<button type="button" class="layui-btn layui-btn-normal">批量导出</button>
				<table class="layui-table" lay-skin="line">
					<colgroup>
						<col width="150">
						<col width="200">
						<col>
					</colgroup>
					<thead>
						<tr class="tatou">
							<th style="width: 50px">
								<input type="checkbox" name="" title="" lay-skin="primary">
							</th>
							<th>平台编号</th>
							<th>会员编号</th>
							<th>会员姓名</th>
							<th>入会日期</th>
							<th>推荐单位</th>
							<th>组织身份</th>
							<th>艺术门类</th>
							<th>地域</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody id='tb'>

					</tbody>
				</table>
				<div>

					<div id="layui"></div>
					<div></div>
					<div></div>
				</div>
			</div>
		</div>
	</div>


	<script src="./layui/layui.js"></script>
	<script src="./js/layuicommon.js"></script>
	<script src="./js/jquery.min.js"></script>
	<script src="./js/header.js"></script>
	<script src="./js/common.js"></script>
	<script src="./js/hyfind.js"></script>

	<script>
		var data = {

		};
		let treedata = [];
		$(".tatou").css({ "background-color": "#059afe", "color": "white" });
		// layui.use('laypage', function () {
		// 	var laypage = layui.laypage;

		// 	//执行一个laypage实例
		// 	laypage.render({
		// 		elem: 'shuju' //注意，这里的 test1 是 ID，不用加 # 号
		// 		, count: 5 //数据总数，从服务端得到
		// 		, limit: 1
		// 	});
		// });

		for (var i = 1; i <= 100; i++) {
			let str = '<option value="' + i + '">' + i + '</option>';
			$('#nlinp1').append(str);
			$('#nlinp2').append(str);
		}




		layui.use('form', function () {
			var form = layui.form;
			//民族
			base.commonAjax('clav/nation/getClavNationList', data, function (res) {
				if (res.code == 1) {
					//console.log(res.data);
					res.data.map(item => {
						$('#mzinp').append('<option value="' + item.id + '">' + item.nation + '</option>');
					});
					form.render();
				}
			});
			//籍贯
			base.commonAjax('clav/area/getProvinceList', data, function (res) {
				if (res.code == 1) {
					//console.log(res.data);
					res.data.map(item => {
						$('#jginp').append('<option value="' + item.id + '">' + item.areaName + '</option>');
					});
					form.render();
				}
			});
			//面貌
			base.commonAjax('clav/politicsStatus/getClavPoliticsStatusList', data, function (res) {
				if (res.code == 1) {
					//console.log(res.data);
					res.data.map(item => {
						$('#mminp').append('<option value="' + item.id + '">' + item.politicsStatus + '</option>');
					});
					form.render();
				}
			});

			        //艺术门类
					base.commonAjax('clav/artType/getClavArtTypeList', data, function (res) {
                if (res.code == 1) {
                    console.log(res.data);
                    res.data.map(item => {
                        $('#ysmlinp').append('<option value="' + item.id + '">' + item.artType + '</option>');
                    });
                    form.render();
                }
            });

		});




		function wtf(data) {
			data.map((v, i) => {
				let obj = {};
				obj.title = v.areaName;
				obj.id = i;
				obj.children = [];
				v.childList.map((val, ind) => {
					let objc = {};
					objc.title = val.areaName;
					objc.id = i + '-' + ind;
					objc.children = [];
					val.childList.map((vv, ii) => {
						let objcc = {};
						objcc.title = vv.areaName;
						objcc.id = i + '-' + ind + '-' + ii;
						objc.children.push(objcc);
					})
					obj.children.push(objc);
				});
				treedata.push(obj);
			});
		}

		base.commonAjax('clav/area/getAddressList', data, function (data) {
			if (data.code == 1) {
				//console.log("z", data);
				wtf(data.data);
				// console.log(treedata)
				layui.use('tree', function () {
					var tree = layui.tree;

					//渲染
					var inst1 = tree.render({
						elem: '#test3'  //绑定元素
						, click: function (obj) {
							// console.log(obj.data); //得到当前点击的节点数据
							// console.log(obj.elem); //得到当前节点元素 
							// console.log($('.layui-tree-set').attr("data-id"));
							//  console.log(obj.data.id); //得到当前点击的节点数据
							let str = obj.data.id;
							// console.log(str.indexOf('-')>-1);
							if (str.indexOf('-') > -1 && str.indexOf('-')) {
								let arr = str.split('-');
								if (arr.length == 3) {
									// console.log(arr);
									// console.log(treedata[arr[0]].title);
									// console.log(treedata[arr[0]].title);
									// console.log(obj.data.title);
									var place = treedata[arr[0]].title + "-" + treedata[arr[0]].title + "-" + obj.data.title;
									//console.log("地区",place);
									$('#xszdinp').val(place);
									$('#test3').css("visibility", "hidden");
								}
							}
						}
						, data: treedata
					});

				});
			}
		});
		$('#xszdinp').click(function () {
			$('#test3').css("visibility", "visible");
		});


		base.commonAjax('clav/member/getClavMemberList', data, function (data) {
			var pagedata = [];
			console.log(data);
			pagedata = data.data;
			//console.log(pagedata)

			//调用分页
			layui.use(['laypage', 'layer'], function () {
				var laypage = layui.laypage
					, layer = layui.layer;

				laypage.render({
					elem: 'layui'
					, count: pagedata.length,
					layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
					limit: 2,
					jump: function (obj) {
						//模拟渲染
						document.getElementById('tb').innerHTML = function () {
							var arr = []
								, thisData = pagedata.concat().splice(obj.curr * obj.limit - obj.limit, obj.limit);
							layui.each(thisData, function (index, item) {
								arr.push(auto(item));
								console.log(item);
							});
							return arr.join('');
						}();
					}
				});
			});
		});



		function auto(obj) {
			return '<tr>' +
				'<td style="width: 50px">' +
				'<input type="checkbox" name="" title="" lay-skin="primary">' +
				'</td>' +
				'<td>' + 123 + '</td>' +
				'<td>' + obj.memberNo + '</td>' +
				'<td>' + obj.name + '</td>' +
				'<td>' + obj.createDate + '</td>' +
				'<td>' + obj.recommendType + '</td>' +
				'<td>' + obj.orgIdentityId + '</td>' +
				'<td>' + obj.artTypeId + '</td>' +
				'<td>' + obj.location + '</td>' +
				'<td>' +
				'<button class="layui-btn">查看</button>' +
				'<button class="layui-btn layui-btn-normal">导出</button>' +
				'</td>' +
				'</tr>'
		}




		$('#szd').click(function () {
			$('#test1').css("visibility", "visible");
		})
		$('#btnclear').click(function () {
			$('#vipname,#vipnumber,#arttype,#szd,#time1,#time2,#tjdw,#zzsf').val('');
			//$('#arttype,#zzsf').empty();
			//form.render("select");
		})
		layui.use('form', function () {
			var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功
			form.on('#btnclear', function (elem) {
				//执行清空
				$("#arttype").empty();
				form.render();
			});

		})
	</script>
</body>

</html>